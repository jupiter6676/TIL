# 1. ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬ (Binary Indexed Tree)â­â­â­â­â­

- íŠ¹ìˆ˜ ëª©ì ì˜ ìë£Œêµ¬ì¡°
- https://visualgo.net/en/fenwicktree



## (1) ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬

- **2ì§„ë²• ì¸ë±ìŠ¤** êµ¬ì¡°

- íœìœ… íŠ¸ë¦¬(Fenwick Tree)ë¼ê³ ë„ í•œë‹¤.

- ì •ìˆ˜ì— ë”°ë¥¸ 2ì§„ìˆ˜ í‘œê¸° â†’ [2ì˜ ë³´ìˆ˜ êµ¬í•˜ê¸°, ì™œ 2ì˜ ë³´ìˆ˜ëŠ” ìŒìˆ˜ì¸ê°€?](https://life-with-coding.tistory.com/298)

  - -7 : 7ì˜ ëª¨ë“  ë¹„íŠ¸ë¥¼ Flipí•œ í›„, ë§ˆì§€ë§‰ì— 1ì„ ë”í•¨.

  | ì •ìˆ˜ | 2ì§„ìˆ˜ í‘œê¸°                         |
  | ---- | ---------------------------------- |
  | 7    | 00000000 00000000 00000000 0000111 |
  | -7   | 11111111 11111111 11111111 1111001 |



## (2) 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸

- 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë¥¼ ì°¾ëŠ” ë°©ë²•â£ï¸

  - íŠ¹ì •í•œ ìˆ«ì Kì˜ 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë¥¼ ì°¾ê¸° ìœ„í•´ì„œ, **`K & -K`**ë¥¼ ê³„ì‚°



- **`K & -K`**ê³„ì‚° ê²°ê³¼ ì˜ˆì‹œ

  - 0ì´ ì•„ë‹Œ ê°€ì¥ ë§ˆì§€ë§‰ ë¹„íŠ¸ ìë¦¿ìˆ˜ â†’ 10ì§„ìˆ˜ë¡œ

    | ì •ìˆ˜ K | 2ì§„ìˆ˜ í‘œê¸°   | K & -K |
    | ------ | ------------ | ------ |
    | 0      | 00000000     | 0      |
    | 1      | 0000000**1** | 1      |
    | 2      | 000000**1**0 | 2      |
    | 3      | 0000001**1** | 1      |
    | 4      | 00000**1**00 | 4      |
    | 5      | 0000010**1** | 1      |
    | 6      | 000001**1**0 | 2      |
    | 7      | 0000011**1** | 1      |
    | 8      | 0000**1**000 | 8      |



- ì–‘ì˜ ì •ìˆ˜ë¥¼ 2ì˜ ë³´ìˆ˜ë²•ì„ í†µí•´ ìŒì˜ ì •ìˆ˜ë¡œ ë§Œë“  í›„, ë¹„íŠ¸ ë‹¨ìœ„ and ì—°ì‚°ì„ í•˜ê³ , 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë¥¼ ê°€ì ¸ì˜¤ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•´?

  - íŒŒì´ì¬ì—ì„œëŠ” ê·¸ëƒ¥ í•˜ë©´ ë¼

  - ì˜ˆì‹œ

    ```python
    n = 8
    
    for i in range(n + 1):
        print(f'{i}ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: {i & -i}')
    ```

    ```
    0ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 0
    1ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 1
    2ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 2
    3ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 1
    4ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 4
    5ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 1
    6ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 2
    7ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 1
    8ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸: 8
    ```



# 2. ë°ì´í„° ì—…ë°ì´íŠ¸ê°€ ê°€ëŠ¥í•œ ìƒí™©ì—ì„œì˜ êµ¬ê°„ í•© (Interval Sum) ë¬¸ì œğŸ’™

- [ë°±ì¤€ 'êµ¬ê°„ í•© êµ¬í•˜ê¸°' ë¬¸ì œ](https://www.acmicpc.net/problem/2042)
- ì–´ë–¤ Nê°œì˜ ìˆ˜ê°€ ì£¼ì–´ì ¸ ìˆë‹¤. ê·¸ëŸ°ë° ì¤‘ê°„ì— ìˆ˜ì˜ ë³€ê²½ì´ ë¹ˆë²ˆíˆ ì¼ì–´ë‚˜ê³  ê·¸ ì¤‘ê°„ì— ì–´ë–¤ ë¶€ë¶„ì˜ í•©ì„ êµ¬í•˜ë ¤ í•œë‹¤. ë§Œì•½ì— 1,2,3,4,5 ë¼ëŠ” ìˆ˜ê°€ ìˆê³ , 3ë²ˆì§¸ ìˆ˜ë¥¼ 6ìœ¼ë¡œ ë°”ê¾¸ê³  2ë²ˆì§¸ë¶€í„° 5ë²ˆì§¸ê¹Œì§€ í•©ì„ êµ¬í•˜ë¼ê³  í•œë‹¤ë©´ 17ì„ ì¶œë ¥í•˜ë©´ ë˜ëŠ” ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  ê·¸ ìƒíƒœì—ì„œ ë‹¤ì„¯ ë²ˆì§¸ ìˆ˜ë¥¼ 2ë¡œ ë°”ê¾¸ê³  3ë²ˆì§¸ë¶€í„° 5ë²ˆì§¸ê¹Œì§€ í•©ì„ êµ¬í•˜ë¼ê³  í•œë‹¤ë©´ 12ê°€ ë  ê²ƒì´ë‹¤.
- ë°ì´í„° ê°œìˆ˜: N (1 â‰¤ N â‰¤ **1,000,000**)
- ë°ì´í„° ë³€ê²½ íšŸìˆ˜: M (1 â‰¤ M â‰¤ **10,000**)
- êµ¬ê°„ í•© ê³„ì‚° íšŸìˆ˜: K (1 â‰¤ K â‰¤ **10,000**)
- ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œ?
  - ë§Œì•½ ì„ í˜•ì ìœ¼ë¡œ í•œë‹¤ë©´, N Ã— K ë§Œí¼ì˜ ì—°ì‚°ì´ í•„ìš”
  - ë” íš¨ìœ¨ì ìœ¼ë¡œ í•˜ë ¤ë©´ ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬ë¥¼ í™œìš©!
  - ìµœì•…ì˜ ê²½ìš°ì—ë„, **O(logN)**ì˜ ë³µì¡ë„ë¥¼ ë³´ì¥



## (1) ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬ êµ¬ì¡° ë§Œë“¤ê¸°â¤ï¸

1. íŠ¸ë¦¬ êµ¬ì¡° ë§Œë“¤ê¸°

   ![image-20220716171623113](Assets/04_Binary-Indexed-Tree.assets/image-20220716171623113.png)

   - Nê°œì˜ ë°ì´í„°, Nê°œì˜ ì¸ë±ìŠ¤
   - ì¸ë±ìŠ¤ì˜ 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ = ë‚´ê°€ ì €ì¥í•˜ê³  ìˆëŠ” ê°’ë“¤ì˜ ê°œìˆ˜
     - ì¸ë±ìŠ¤ëŠ” ë”í•´ì§€ëŠ” ìˆ˜ê°€ ì•„ë‹ˆë¼, **ë°ì´í„°ì˜ i ë²ˆì§¸ ìˆ˜**ë¥¼ ì˜ë¯¸
     - í•´ë‹¹ ì¸ë±ìŠ¤ì—ëŠ” 1 ~ i ê¹Œì§€ì˜ ë°ì´í„°ë“¤ì˜ í•©ì´ ë‹´ê¹€

   - ì¸ë±ìŠ¤ 16
     - 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ê°€ 16
     - 1 ~ 16ê¹Œì§€ì˜, ê°’ë“¤ì˜ í•©ì„ ë‹´ê² ë‹¤ëŠ” ì˜ë¯¸



2. íŠ¹ì • ê°’ì„ ë³€ê²½í•  ë•Œâ¤ï¸

   - 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë§Œí¼ ë”í•˜ë©´ì„œ êµ¬ê°„ë“¤ì˜ ê°’ì„ ë³€ê²½
   - ì˜ˆì‹œ (3rd)
     - 3ë²ˆì§¸ ê°’ì´ ë³€ê²½ë¨.
     - ì¸ë±ìŠ¤ 3ì˜ 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ëŠ” 1.
     - ë’¤ë¡œ 1ì¹¸ ì´ë™, ì¸ë±ìŠ¤ 4ì— ëŒ€í•œ ê°’(1 ~ 4ë²ˆì§¸ ë°ì´í„°ë“¤ì˜ í•©)ì„ ë°”ê¿ˆ.
     - ì¸ë±ìŠ¤ 4ì—ì„œ ë’¤ë¡œ 4ì¹¸ ì´ë™, ì¸ë±ìŠ¤ 8ì— ëŒ€í•œ ê°’(1 ~ 8ë²ˆì§¸ ë°ì´í„°ë“¤ì˜ í•©)ì„ ë°”ê¿ˆ.
     - ì¸ë±ìŠ¤ 8ì—ì„œ ë’¤ë¡œ 8ì¹¸ ì´ë™, ì¸ë±ìŠ¤ 16ì— ëŒ€í•œ ê°’(1 ~ 16ë²ˆì§¸ ë°ì´í„°ë“¤ì˜ í•©)ì„ ë°”ê¿ˆ.
     - ì´ 4ë²ˆì˜ ê°’ ì—…ë°ì´íŠ¸

   ![image-20220716172209334](Assets/04_Binary-Indexed-Tree.assets/image-20220716172209334.png)



## (2) ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬: ëˆ„ì  í•© (Prefix Sum)ğŸ’›

1. 1ë¶€í„° Nê¹Œì§€ì˜ í•© (ëˆ„ì  í•©) êµ¬í•˜ê¸°

   - 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë§Œí¼ ë¹¼ë©´ì„œ êµ¬ê°„ë“¤ì˜ ê°’ì˜ í•© ê³„ì‚°
   - ì˜ˆì‹œ (11th)
     - 11ë¶€í„° ì¶œë°œ
     - 11ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸ ìˆ˜ì¸ 1ë§Œí¼ ì™¼ìª½ìœ¼ë¡œ ì´ë™ â†’ 10
     - 10ì€ 9 ~ 10ë²ˆì§¸ ìˆ˜ë“¤ì˜ í•©ì„ ë‹´ê³  ìˆìŒ. ê·¸ê±¸ 11ë²ˆì§¸ ìˆ˜ì™€ ë”í•¨.
     - 10ì˜ ë§ˆì§€ë§‰ ë¹„íŠ¸ ìˆ˜ì¸ 2ë§Œí¼ ì™¼ìª½ìœ¼ë¡œ ì´ë™ â†’ 8
     - 8ì€ 1 ~ 8ë²ˆì§¸ ìˆ˜ë“¤ì˜ í•©ì„ ë‹´ê³  ìˆìŒ. ê·¸ê±¸ ì•„ê¹Œ ë”í•œ ê²ƒì— ë”í•¨.

   ![image-20220716173409887](Assets/04_Binary-Indexed-Tree.assets/image-20220716173409887.png)



## (3) ë°”ì´ë„ˆë¦¬ ì¸ë±ìŠ¤ íŠ¸ë¦¬ êµ¬í˜„

1. ì „ì—­ ë³€ìˆ˜ ì„ ì–¸

   ```python
   import sys
   input = sys.stdin.readline
   
   # ë°ì´í„° ê°œìˆ˜(n), ë³€ê²½ íšŸìˆ˜(m), êµ¬ê°„ í•© ê³„ì‚° íšŸìˆ˜(k)
   n, m, k = map(int, input().split())
   
   # ì „ì²´ ë°ì´í„° ê°œìˆ˜ëŠ” ìµœëŒ€ 1,000,000ê°œ
   # 0ìœ¼ë¡œ ì´ˆê¸°í™”ëœ ë¦¬ìŠ¤íŠ¸ ìƒì„±
   # n + 1ì¸ ì´ìœ ëŠ”, ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° nê¹Œì§€ ì“°ê¸° ìœ„í•¨
   arr = [0] * (n + 1)
   tree = [0] * (n + 1)
   ```



2. i ë²ˆì§¸ ìˆ˜ê¹Œì§€ì˜ ëˆ„ì  í•©ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ğŸ’›

   ```python
   def prefix_sum(i):
       result = 0
       
       while i > 0:
           result += tree[i]
           
           # 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë§Œí¼ ì™¼ìª½ìœ¼ë¡œ ì´ë™
           i -= (i & -i)
           
       return result
   ```



3. i ë²ˆì§¸ ìˆ˜ë¥¼ diff ë§Œí¼ ë”í•˜ëŠ” í•¨ìˆ˜â¤ï¸

   ```python
   def update(i, diff):
       while i <= n:
           tree[i] += diff
           
           # 0ì´ ì•„ë‹Œ ë§ˆì§€ë§‰ ë¹„íŠ¸ë§Œí¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™
           i += (i & -i)
   ```



4. startë¶€í„° endê¹Œì§€ì˜ êµ¬ê°„ í•©ì„ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜ğŸ’™

   ```python
   def interval_sum(start, end):
       return prefix_sum(end) - prefix_sum(start)
   ```



5. ë©”ì¸

   ```python
   for i in range(1, n + 1):
       x = int(input())
       arr[i] = x
       update(i, x)	# ì²˜ìŒ íŠ¸ë¦¬ ì´ˆê¸°í™”
       
   for i in range(m + k):
       a, b, c = map(int, input().split())
       
       # ì—…ë°ì´íŠ¸ ì—°ì‚°ì¸ ê²½ìš°
       if a == 1:
           update(b, c - arr[b])	# ë°”ë€ í¬ê¸°(diff)ë§Œí¼ ì ìš©
           arr[b] = c
           
       # êµ¬ê°„ í•© ì—°ì‚°ì¸ ê²½ìš°
       else:
           print(interval_sum(b, c))
   ```

