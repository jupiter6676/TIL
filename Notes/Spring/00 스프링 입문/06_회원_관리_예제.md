# íšŒì› ê´€ë¦¬ ì˜ˆì œ - ë°±ì—”ë“œ ê°œë°œ

## 1. ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ì •ë¦¬

- ë°ì´í„°: íšŒì› ID, ì´ë¦„
- ê¸°ëŠ¥: íšŒì› ë“±ë¡, ì¡°íšŒ
- ê°€ìƒ ì‹œë‚˜ë¦¬ì˜¤: ì•„ì§ ë°ì´í„° ì €ì¥ì†Œê°€ ì„ ì •ë˜ì§€ ì•ŠìŒ



### (1) ì¼ë°˜ì  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ êµ¬ì¡°

![image-20230606201133034](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230606201133034.png)

- ì»¨íŠ¸ë¡¤ëŸ¬: ì›¹ MVCì˜ ì»¨íŠ¸ë¡¤ëŸ¬ ì—­í• 
- ì„œë¹„ìŠ¤: ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´ë¥¼ ê°€ì§€ê³  **í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„** (ex. íšŒì›ì€ ì¤‘ë³µ ê°€ì…ì´ ì•ˆ ëœë‹¤.)
- ë¦¬í¬ì§€í† ë¦¬: ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼, ë„ë©”ì¸ ê°ì²´ë¥¼ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬
- ë„ë©”ì¸: **ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê°ì²´** (ex. íšŒì›, ì£¼ë¬¸, ì¿ í° ë“± ì£¼ë¡œ DBì— ì €ì¥í•˜ê³  ê´€ë¦¬ë˜ëŠ” ê°ì²´)



### (2) í´ë˜ìŠ¤ ì˜ì¡´ ê´€ê³„

![image-20230606201933716](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230606201933716.png)

- MemberService: íšŒì› ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- MemberRepository: íšŒì› ì €ì¥
- ì•„ì§ ë°ì´í„° ì €ì¥ì†Œê°€ ì„ ì •ë˜ì§€ ì•Šì•˜ë‹¤ëŠ” ê°€ìƒ ì‹œë‚˜ë¦¬ì˜¤ í•˜ì—, ìš°ì„  **ì¸í„°í˜ì´ìŠ¤**ë¡œ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„
- ë°ì´í„° ì €ì¥ì†ŒëŠ” RDB, NoSQL ë“± ë‹¤ì–‘í•œ ì €ì¥ì†Œë¥¼ ê³ ë¯¼ ì¤‘ì¸ ìƒí™©ìœ¼ë¡œ ê°€ì •
- ê°œë°œì„ ì§„í–‰í•˜ê¸° ìœ„í•´ì„œ, ì´ˆê¸° ê°œë°œ ë‹¨ê³„ì—ì„œëŠ” **êµ¬í˜„ì²´**ë¡œ ê°€ë²¼ìš´ ë©”ëª¨ë¦¬ ê¸°ë°˜ì˜ ë°ì´í„° ì €ì¥ì†Œ ì‚¬ìš©
  - ì¶”í›„ì— ë°ì´í„° ì €ì¥ì†Œ ê²°ì • í›„, ê·¸ê±¸ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ì„œ ì¸í„°í˜ì´ìŠ¤ê°€ í•„ìš”í•œ ê²ƒ



## 2. íšŒì› ë„ë©”ì¸ê³¼ ë¦¬í¬ì§€í† ë¦¬ ë§Œë“¤ê¸°

### (1) íšŒì› ê°ì²´

- `hello.hellospring` í´ë” ì•„ë˜, `domain` packageë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

  - [ìë°” íŒ¨í‚¤ì§€](https://wikidocs.net/231)

- ê·¸ë¦¬ê³  ê·¸ ì•ˆì— `Member` í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

  ![image-20230614201301482](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230614201301482.png)



---

- **ğŸ“‘ `Member` í´ë˜ìŠ¤ ì‘ì„±**

  ```java
  package hello.hellospring.domain;
  
  public class Member {
  
      private Long id;
      private String name;
  
      public Long getId() {
          return id;
      }
  
      public void setId(Long id) {
          this.id = id;
      }
  
      public String getName() {
          return name;
      }
  
      public void setName(String name) {
          this.name = name;
      }
  }
  ```

  - `id`, `name` í•„ë“œë¥¼ ì„ ì–¸
  - ê°ê° Getterì™€ Setterë¥¼ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤.

---



### (2) íšŒì› ë¦¬í¬ì§€í† ë¦¬ ì¸í„°í˜ì´ìŠ¤

> ìœ„ì—ì„œ ë§Œë“  íšŒì› ê°ì²´ë¥¼ ì €ì¥í•  ì €ì¥ì†Œ

- `hello.hellospring` í´ë” ì•„ë˜, `repository` packageë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

- ê·¸ë¦¬ê³  ê·¸ ì•ˆì— `MemberRepository` ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

  - [ìë°” ì¸í„°í˜ì´ìŠ¤](https://limkydev.tistory.com/197)

  - [ì¸í„°í˜ì´ìŠ¤ íŠ¹ì§•](https://coding-factory.tistory.com/867)

    ![image-20230614202024764](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230614202024764.png)



---

- **ğŸ“‘ `MemberRepository` ì¸í„°í˜ì´ìŠ¤ ì‘ì„±**

  ```java
  package hello.hellospring.repository;
  
  import hello.hellospring.domain.Member;
  import java.util.List;
  import java.util.Optional;
  
  public interface MemberRepository {
      Member save(Member member); // íšŒì› ì €ì¥
      Optional<Member> findById(Long id); // ì•„ì´ë””ë¡œ íšŒì› ì°¾ê¸°
      Optional<Member> findByName(String name);   // ì´ë¦„ìœ¼ë¡œ íšŒì› ì°¾ê¸°
      List<Member> findAll(); // ì €ì¥ëœ ëª¨ë“  íšŒì› ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
  }
  ```

  - `save()`: ì¸ìë¡œ ë“¤ì–´ê°„ íšŒì›ì„ ì €ì¥í•œë‹¤.
  - `findById`(): ì¸ìë¡œ ë“¤ì–´ê°„ idë¡œ íšŒì›ì„ ì°¾ëŠ”ë‹¤.
    - `Optional`: nullì´ ë  ìˆ˜ ìˆëŠ” ê°’ì„ ê°ì‹¸ëŠ” Wrapper í´ë˜ìŠ¤. ([ìë°” Optional](https://mangkyu.tistory.com/70))
  - `findByName()`: ì¸ìë¡œ ë“¤ì–´ê°„ ì´ë¦„ìœ¼ë¡œ íšŒì›ì„ ì°¾ëŠ”ë‹¤.
  - `findAll()`: ëª¨ë“  íšŒì› ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤.

---



### (3) êµ¬í˜„ì²´ í´ë˜ìŠ¤

- `hello.hellospring/Repository` íŒ¨í‚¤ì§€ ì•ˆì—, `MemoryMemberRepository` í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

  ![image-20230614203519698](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230614203519698.png)



---

- **ğŸ“‘ `MemoryMemberRepository` í´ë˜ìŠ¤ ì‘ì„±**

  ```java
  package hello.hellospring.repository;
  
  import hello.hellospring.domain.Member;
  import java.util.*;
  
  public class MemoryMemberRepository implements MemberRepository {
  
      private static Map<Long, Member> store = new HashMap<>();   // id-Member
      private static long sequence = 0L;  // key ê°’ ìƒì„±
  
      @Override
      public Member save(Member member) { // memberì˜ nameì€, íšŒì›ì´ ì…ë ¥í•´ì„œ ë„˜ì–´ì˜¨ ìƒíƒœ
          member.setId(++sequence);       // idëŠ” ì‹œìŠ¤í…œì—ì„œ ì„¤ì •
          store.put(member.getId(), member);
  
          return member;
      }
  
      @Override
      public Optional<Member> findById(Long id) {
          return Optional.ofNullable(store.get(id));
      }
  
      @Override
      public Optional<Member> findByName(String name) {
          return store.values().stream()
                  .filter(member -> member.getName().equals(name))
                  .findAny(); // storeì˜ ê°’ë“¤(Member) ì¤‘, nameê³¼ ê°™ì€ ê²ƒì´ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ë°˜í™˜
      }
  
      @Override
      public List<Member> findAll() {
          return new ArrayList<>(store.values());
      }
  }
  ```

  - `store`: idë¥¼ í‚¤, Memberë¥¼ ê°’ìœ¼ë¡œ ê°€ì§€ëŠ” í•´ì‹œë§µ
  - `sequence`: íšŒì› ì €ì¥ ì‹œ, ì´ ë³€ìˆ˜ë¥¼ í†µí•´ idë¥¼ ì„¤ì •í•œë‹¤.
  - `save()`: íšŒì›ì˜ idë¥¼ ì„¤ì •í•˜ì—¬ ì €ì¥í•˜ê³ , ì €ì¥ëœ Memberë¥¼ ë°˜í™˜í•œë‹¤.
  - `findById()`: `store`ì—ì„œ í•´ë‹¹ id ê°’ì„ ê°€ì§„ Memberë¥¼ ì°¾ì•„ ë°˜í™˜í•œë‹¤.
  - `findByName()`: `store`ì˜ ëª¨ë“  Member ì¤‘, í•´ë‹¹ name ê°’ì„ ê°€ì§„ Memberë¥¼ ì°¾ì•„ ë°˜í™˜í•œë‹¤.
  - `findAll()`: `store`ì˜ ëª¨ë“  Memberë¥¼ ë¦¬ìŠ¤íŠ¸í™”í•˜ì—¬ ë°˜í™˜í•œë‹¤.

---



- âœ¨ **ë™ì‹œì„± ë¬¸ì œ**
  - `store`ê³¼ ê°™ì´ ì´ë ‡ê²Œ ê³µìœ ë˜ëŠ” ë³€ìˆ˜ì¼ ë•ŒëŠ” `ConcurrentHashMap`ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. (ì˜ˆì œë‹ˆê¹Œ ê·¸ëƒ¥ HashMap ì‚¬ìš©)
  - `long` ìë£Œí˜•ë„ `AtomicLong`ì„ ì‚¬ìš©í•œë‹¤.
- âœ¨ **HashMap.values()**: í•´ì‹œë§µì˜ ê°’ ëª©ë¡ì„ Collection í˜•íƒœë¡œ ë°˜í™˜
- âœ¨ **Stream**
  - [ìë°” Stream](https://futurecreator.github.io/2018/08/26/java-8-streams/)
  - Array ë˜ëŠ” Collection ì¸ìŠ¤í„´ìŠ¤ì— í•¨ìˆ˜ ì—¬ëŸ¬ ê°œë¥¼ ì¡°í•©í•˜ì—¬, ì›í•˜ëŠ” ê²°ê³¼ë¥¼ í•„í„°ë§í•˜ê±°ë‚˜ ê°€ê³µí•œë‹¤.
  - ì´ë•Œ í•¨ìˆ˜ëŠ” ëŒë‹¤ì‹ì„ ì´ìš©í•  ìˆ˜ë„ ìˆë‹¤.
  - ì¦‰, ë°°ì—´ê³¼ ì½œë ‰ì…˜ì„ í•¨ìˆ˜í˜•ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ ì¤€ë‹¤.
  - ì“°ë ˆë“œë¥¼ ì´ìš©í•˜ì—¬, í•˜ë‚˜ì˜ ì‘ì—…ì„ ë‘˜ ì´ìƒì˜ ì‘ì—…ìœ¼ë¡œ ì˜ê²Œ ë‚˜ëˆ  ë™ì‹œì— ì§„í–‰í•˜ëŠ” ë³‘ë ¬ ì²˜ë¦¬(Multi-threading)ë¥¼ ê°„ë‹¨íˆ í•  ìˆ˜ ìˆë‹¤.
- âœ¨ **ArrayList**
  - [ìë°” ArrayList](https://psychoria.tistory.com/765)
  - ì¼ë°˜ ë°°ì—´ê³¼ ê°™ì´ ì—°ì†ëœ ë©”ëª¨ë¦¬ ê³µê°„ ì‚¬ìš©, ì¸ë±ìŠ¤ëŠ” 0ë¶€í„° ì‹œì‘
  - ë°°ì—´ì€ í¬ê¸°ê°€ ê³ ì •ì¸ ë°˜ë©´, ArrayListëŠ” í¬ê¸°ê°€ ê°€ë³€ì ì´ë‹¤.



## 3. íšŒì› ë¦¬í¬ì§€í† ë¦¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±

- ê°œë°œí•œ ê¸°ëŠ¥ì„ ì‹¤í–‰í•´ í…ŒìŠ¤íŠ¸í•  ë•Œ, ìë°”ì˜ main ë©”ì†Œë“œë¥¼ í†µí•´ ì‹¤í–‰í•˜ê±°ë‚˜, ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í†µí•´ ì‹¤í–‰í•œë‹¤.
- ì´ëŸ° ë°©ë²•ì€ ì¤€ë¹„í•˜ê³  ì‹¤í–‰í•˜ëŠ”ë° ì˜¤ë˜ ê±¸ë¦¬ê³ , ë°˜ë³µ ì‹¤í–‰í•˜ê¸° ì–´ë ¤ìš°ë©°, ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ë¥¼ í•œ ë²ˆì— ì‹¤í–‰í•˜ê¸° ì–´ë µë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.
- ìë°”ëŠ” JUnitì´ë¼ëŠ” í”„ë ˆì„ì›Œí¬ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´, ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.



### (1) íšŒì› ì €ì¥ í…ŒìŠ¤íŠ¸

- `src/java/hello.spring` í´ë”ì— `repository` íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œë‹¤.

  - mainê³¼ ê°™ì€ ì´ë¦„ì˜ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ê²Œ ëœë‹¤.

    ![image-20230619205128303](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230619205128303.png)



- í…ŒìŠ¤íŠ¸ ì‹œ ê´€ë¡€ê°€ ìˆëŠ”ë°, `MemoryMemeberRepository`ë¥¼ í…ŒìŠ¤íŠ¸í•  ë•Œ, `MemoryMemberRepositoryTest`ì™€ ê°™ì´ ë’¤ì— '~Test'ë¥¼ ë¶™ì´ê²Œ ëœë‹¤.
- í•´ë‹¹ ì´ë¦„ì˜ í´ë˜ìŠ¤ë¥¼ `repository` ì•ˆì— ìƒì„±í•œë‹¤.



- êµ¬ì¡°ì²´ ì•ˆì˜ í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì„ ë• `@Test`ë¥¼ í†µí•´, ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê³ ë„ í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

  ![image-20230619205449583](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230619205449583.png)



---

- **ğŸ“‘ `MemoryMemberRepositoryTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- `save()` í•¨ìˆ˜ ì‘ì„±

  ```java
  package hello.hellospring.repository;
  
  import hello.hellospring.domain.Member;
  import org.junit.jupiter.api.Test;
  
  public class MemoryMemberRepositoryTest {
  
      MemberRepository repository = new MemoryMemberRepository();
  
      @Test
      public void save() {
          Member member = new Member();
          member.setName("spring");
  
          repository.save(member);    // ì €ì¥
  
          Member result = repository.findById(member.getId()).get();  // ì €ì¥ í›„ í™•ì¸
          System.out.println("result = " + (result == member));
      }
  }
  ```

---



- íšŒì›ì„ ì €ì¥í•˜ëŠ” í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„ `save()` í•¨ìˆ˜ë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ë©´, `result = true`ë¼ê³  ì¶œë ¥ëœë‹¤.

  ![image-20230619210234048](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230619210234048.png)



- `Assertions.assertEquals(expected, actual)`

  ```java
  // System.out.println("result = " + (result == member));
  Assertions.assertEquals(member, result);
  ```

  - `org.junit.jupiter.api.Assertions`
  - ì €ì¥í•œ ê¸°ëŒ€í•˜ëŠ” ê°’ì€ member, ì €ì¥ëœ ê²ƒì„ êº¼ë‚´ì˜¨ ê°’ì€ result.
  - ë‘˜ì´ ê°™ì€ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  - ê°™ìœ¼ë©´ ë…¹ìƒ‰ ë¶ˆì´ ì¼œì§€ê³  ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠëŠ” ë°˜ë©´, ë‹¤ë¥´ë©´ ë¹¨ê°„ ë¶ˆì´ ë“¤ì–´ì˜¨ë‹¤.



- Assertions.assertionThat()

  ```java
  // System.out.println("result = " + (result == member));
  // Assertions.assertEquals(member, result);
  Assertions.assertThat(member).isEqualTo(result);
  ```

  - `org.assertj.core.api.Assertions`
  - ì´ê±¸ ë” ë§ì´ ì“´ë‹¤.
  - **alt + Enter**ë¥¼ ëˆŒëŸ¬ `import static org.assertj.core.api.Assertions.*assertThat*;`ì„ í•˜ë©´, ì•ì˜ Assertionsë¥¼ ë¹¼ë„ ëœë‹¤.
  - ì‹¤ë¬´ì—ì„œëŠ” ë¹Œë“œ íˆ´ì—ì„œ ë¹Œë“œí•  ë•Œ, ì˜¤ë¥˜ë¥¼ í†µê³¼í•˜ì§€ ëª»í•˜ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ëª» ë„˜ì–´ê°€ê²Œ ë§‰ëŠ” ì‹ìœ¼ë¡œ í™œìš©í•œë‹¤.



### (2) íšŒì› ì´ë¦„ ì°¾ê¸° í…ŒìŠ¤íŠ¸

---

- **ğŸ“‘ `MemoryMemberRepositoryTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- `findByName()` í•¨ìˆ˜ ì‘ì„±

  ```java
  @Test
  public void findByName() {
      Member member1 = new Member();
      member1.setName("spring1");
      repository.save(member1);
  
      // ìœ„ì—ê±° ë³µì‚¬í•˜ê³  shift + f6 â†’ ë³€ìˆ˜ ì´ë¦„ í•œ ë²ˆì— ë°”ê¾¸ê¸°
      Member member2 = new Member();
      member2.setName("spring2");
      repository.save(member2);
  
      // Optional<Member> result = repository.findByName("spring1");
      Member result = repository.findByName("spring1").get();
  
      assertThat(result).isEqualTo(member1);
  }
  ```

  - `member2` ë¶€ë¶„ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ, `member1` ì½”ë“œë¥¼ ê°€ì ¸ì˜¨ í›„, ë³€ìˆ˜ ì´ë¦„ì„ ì„ íƒí•œ ë‹¤ìŒ **Shift + F6**ìœ¼ë¡œ ë³€ìˆ˜ì˜ ì´ë¦„ì„ í•œ ë²ˆì— ë°”ê¿€ ìˆ˜ ìˆë‹¤.
  - `result`ì™€ `member1`ì„ ë¹„êµí•˜ë©´ ì•„ë¬´ ë¬¸ì œê°€ ì—†ì§€ë§Œ, `result`ì™€ `member2`ë¥¼ ë¹„êµí•˜ë©´ ì˜¤ë¥˜ê°€ ëœ¬ë‹¤. 

---



### (3) ì „ì²´ ì½”ë“œ

- í´ë˜ìŠ¤ ë ˆë²¨ì—ì„œ ì‹¤í–‰í•˜ë©´ ì—¬ëŸ¬ ê°œì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê³ , `hello.hellospring` ë ˆë²¨ì—ì„œ ì‹¤í–‰í•  ìˆ˜ë„ ìˆë‹¤.



---

- **ğŸ“‘ `MemoryMemberRepositoryTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- `findAll()` í•¨ìˆ˜ ì¶”ê°€

  ```java
  @Test
  public void findAll() {
      Member member1 = new Member();
      member1.setName("spring1");
      repository.save(member1);
  
      Member member2 = new Member();
      member2.setName("spring2");
      repository.save(member2);
  
      List<Member> result = repository.findAll();
  
      assertThat(result.size()).isEqualTo(2);
  }
  ```

---



- ê·¸ëŸ°ë°? ë§‰ìƒ ë‹¤ í•´ë†“ê³  í´ë˜ìŠ¤ ë ˆë²¨ì—ì„œ ì‹¤í–‰í•˜ë©´ ì˜¤ë¥˜ê°€ ë‚œë‹¤.

- ì™¼ìª½ì˜ í…ŒìŠ¤íŠ¸ ìˆœì„œë¥¼ ë³´ë©´ `findAll()` â†’ `findByName()` â†’ `save()` ìˆœì„œë¡œ ì‹¤í–‰ëœë‹¤.

  ![image-20230619221643785](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230619221643785.png)



- ëª¨ë“  **í…ŒìŠ¤íŠ¸ëŠ” ìˆœì„œê°€ ë³´ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.** ë”°ë¼ì„œ, ìˆœì„œ ìƒê´€ì—†ì´ ë©”ì†Œë“œê°€ ë”°ë¡œ ë™ì‘í•˜ë„ë¡ í…ŒìŠ¤íŠ¸ë¥¼ ì„¤ê³„í•´ì•¼ í•œë‹¤.
- `findAll()`ì—ì„œ `repository`ì— 'spring1', 'spring2'ë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ íšŒì›ì´ ì´ë¯¸ ë“±ë¡ë˜ì—ˆê³ , ê·¸ë•Œ `findByName()`ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒ
- ê·¸ë˜ì„œ í…ŒìŠ¤íŠ¸ê°€ ëë‚˜ê³  ë‚˜ë©´, **ë°ì´í„°ë¥¼ ì§€ì›Œ ì£¼ì–´ì•¼ í•œë‹¤.**



### (4) í…ŒìŠ¤íŠ¸ ë°ì´í„° ì§€ìš°ê¸°

---

- **ğŸ“‘ `MemoryMemberRepository.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- `clearStore()` í•¨ìˆ˜ ì‘ì„±

  ```java
  public void clearStore() {
      store.clear();
  }
  ```



- **ğŸ“‘ `MemoryMemberRepositoryTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

  ```java
  public class MemoryMemberRepositoryTest {
  
      MemoryMemberRepository repository = new MemoryMemberRepository();
  
      @AfterEach  // ë©”ì†Œë“œê°€ ì‹¤í–‰ì´ ëë‚  ë•Œë§ˆë‹¤ ë™ì‘ (ì½œë°± ë©”ì†Œë“œ)
      public void afterEach() {
          repository.clearStore();
      }
  	
      // ...
      
  }
  ```

  - `repository`ë¥¼ `MemberRepository` ì¸í„°í˜ì´ìŠ¤ì—ì„œ `MemoryMemberRepository`ë¡œ ë³€ê²½
  - `@AfterEach`: í•œ ë²ˆì— ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ ë©”ëª¨ë¦¬ DBì— ì§ì „ í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ê°€ ë‚¨ì„ ìˆ˜ ìˆë‹¤. ì´ëŸ¬ë©´ ì´ì „ í…ŒìŠ¤íŠ¸ ë•Œë¬¸ì— ë‹¤ìŒ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ ìƒê¸´ë‹¤. `@AfterEach`ë¥¼ ì‚¬ìš©í•˜ë©´ ê° í…ŒìŠ¤íŠ¸ê°€ ì¢…ë£Œë  ë•Œë§ˆë‹¤ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤.
  - `@AfterEach`ì™€, `MemoryMemberRepository`ì˜ `clearStore()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì˜ ì‹¤í–‰ì´ ëë‚  ë•Œë§ˆë‹¤ ë°ì´í„°ë¥¼ ì§€ìš°ë„ë¡ í•œë‹¤.
  - í…ŒìŠ¤íŠ¸ëŠ” ê°ê° ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸ ìˆœì„œì— ì˜ì¡´ ê´€ê³„ê°€ ìˆëŠ” ê²ƒì€ ì¢‹ì€ í…ŒìŠ¤íŠ¸ê°€ ì•„ë‹ˆë‹¤.

---



- ë¡œì§ì„ ê²€ì¦í•  ìˆ˜ ìˆëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë¨¼ì € ì‘ì„±í•œ í›„, êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•  ìˆ˜ë„ ìˆë‹¤.
- ì´ë¥¼ í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ, **TDD**ë¼ê³  í•œë‹¤.



## 4. íšŒì› ì„œë¹„ìŠ¤ ê°œë°œ

- ë¦¬í¬ì§€í† ë¦¬ì™€ ë„ë©”ì¸ì„ í™œìš©í•´ ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‘ì„±

- ë”°ë¼ì„œ ì„œë¹„ìŠ¤ ê´€ë ¨ ì½”ë“œë¥¼ ì§¤ ë•ŒëŠ” ë©”ì†Œë“œ ì´ë¦„ì„ ë¹„ì¦ˆë‹ˆìŠ¤ ìš©ì–´ë¡œ ì§“ëŠ”ë‹¤. (ë¦¬í¬ì§€í† ë¦¬ëŠ” ê°œë°œ ìš©ì–´ì— ê°€ê¹ê²Œ)

- `src/java/hello.spring` í´ë”ì— `service` íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œ í›„, `MemberService` í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

  ![image-20230620215130792](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230620215130792.png)



---

- **ğŸ“‘ `MemberService.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- import

  ```java
  package hello.hellospring.service;
  
  import hello.hellospring.domain.Member;
  import hello.hellospring.repository.MemberRepository;
  import hello.hellospring.repository.MemoryMemberRepository;
  
  import java.util.List;
  import java.util.Optional;
  ```



- `MemberService` í´ë˜ìŠ¤

  ```java
  public class MemberService {
  
      private final MemberRepository memberRepository = new MemoryMemberRepository();
  
      /** íšŒì› ê°€ì… */
      public Long join(Member member) {
          validateDuplicateMember(member);    // ì¤‘ë³µëœ ì´ë¦„ì˜ íšŒì›ì€ ê°€ì… X
          memberRepository.save(member);
          return member.getId();
      }
  
      private void validateDuplicateMember(Member member) {
          // memberRepository.findByName(member.getName())ë§Œ ì¨ë†“ê³  Ctrl + Alt + Vë¥¼ í•˜ë©´ Optional ë³€ìˆ˜ì— ì €ì¥
          memberRepository.findByName(member.getName())
                          .ifPresent(m -> {   // nullì´ ì•„ë‹Œ ê°’ì´ë©´, í•´ë‹¹ ë¡œì§ ì‹¤í–‰
                              throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
                          });
      }
  
      /** ì „ì²´ íšŒì› ì¡°íšŒ */
      public List<Member> findMembers() {
          return memberRepository.findAll();
      }
  
      public Optional<Member> findOne(Long memberId) {
          return memberRepository.findById(memberId);
      }
      
  }
  ```

  - `join()` ë©”ì†Œë“œ
    - íšŒì›ê°€ì…
    - `validateDuplicateMember()` ë©”ì†Œë“œë¥¼ í†µí•´ ì´ë¦„ì´ ì¤‘ë³µëœ íšŒì›ì´ ìˆìœ¼ë©´ ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
    - ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš°, íšŒì›ì„ ì €ì¥í•œë‹¤.

  - `validateDuplicateMember()` ë©”ì†Œë“œ

    - ì´ë¦„ì´ ì¤‘ë³µëœ íšŒì›ì´ ìˆìœ¼ë©´ ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
    - ë©”ì†Œë“œë¥¼ ë§Œë“¤ ë•Œ, ë“œë˜ê·¸ í›„ **Ctrl + Shift + Alt + T**ë¥¼ í•˜ë©´ í•´ë‹¹ ë¶€ë¶„ìœ¼ë¡œ ë©”ì†Œë“œ ì¶”ì¶œì´ ê°€ëŠ¥í•˜ë‹¤.

    - `memberRepository.findByName(member.getName())`ëŠ” Optional íƒ€ì…ìœ¼ë¡œ, **Ctrl + Alt + V**ë¥¼ í•˜ë©´ Optional íƒ€ì…ì˜ ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” êµ¬ë¬¸ì´ ìƒê¸´ë‹¤.

  - `findMembers()` ë©”ì†Œë“œ

    - ì €ì¥ëœ íšŒì›ë“¤ì„ List í˜•íƒœë¡œ ë°˜í™˜í•œë‹¤.

  - `findOne()` ë©”ì†Œë“œ

    - id ê°’ì„ í†µí•´ íšŒì›ì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤.

---



## 5. íšŒì› ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸

### (1) í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ìƒì„±

- `MemberService` í´ë˜ìŠ¤ì—ì„œ **Ctrl + Shift + T**ë¥¼ í•˜ë©´, ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

  ![image-20230621213455909](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230621213455909.png)

  ![image-20230621213555770](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230621213555770.png)



- ë‹¤ìŒê³¼ ê°™ì´ `MemberServiceTest` í´ë˜ìŠ¤ê°€ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

  ![image-20230621213705924](Assets/06_íšŒì›_ê´€ë¦¬_ì˜ˆì œ.assets/image-20230621213705924.png)



### (2) í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

- í…ŒìŠ¤íŠ¸ì—ì„œ í•¨ìˆ˜ ì´ë¦„ì„ í•œê¸€ë¡œ ì ì–´ë„ ê´œì°®ë‹¤. (ì§ê´€ì ì´ê³ , ë¹Œë“œì— í¬í•¨ë˜ì§€ ì•Šì•„ì„œ ì‹¤ì œë¡œë„ ë§ì´ í•œë‹¤ê³ ..)
- í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” ì£¼ë¡œ **given - when - then** ë¬¸ë²•ìœ¼ë¡œ ì‘ì„±í•œë‹¤.
  - given: ìƒí™©ê³¼ ë°ì´í„°ê°€ ì£¼ì–´ì§€ê³ ,
  - when: ì´ê±¸ ì‹¤í–‰í–ˆì„ ë•Œ
  - then: ê²°ê³¼ê°€ ë¬´ì—‡ì´ ë‚˜ì™€ì•¼ í•œë‹¤.



---

- **ğŸ“‘ `MemberServiceTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

- import

  ```java
  package hello.hellospring.service;
  
  import hello.hellospring.domain.Member;
  import hello.hellospring.repository.MemoryMemberRepository;
  import org.assertj.core.api.Assertions;
  import org.junit.jupiter.api.Test;
  
  import static org.assertj.core.api.Assertions.*;
  import static org.junit.jupiter.api.Assertions.*;
  ```



- í•„ë“œ ë³€ìˆ˜

  ```java
  MemberService memberService = new MemberService();
  MemoryMemberRepository memberRepository = new MemoryMemberRepository(); // í…ŒìŠ¤íŠ¸ ë°ì´í„° í´ë¦¬ì–´ë¥¼ ìœ„í•´ ê°€ì ¸ì˜´.
  ```



- `afterEach()` í•¨ìˆ˜ ì‘ì„±

  ```java
  @AfterEach  // ë©”ì†Œë“œê°€ ì‹¤í–‰ì´ ëë‚  ë•Œë§ˆë‹¤ ë™ì‘ (ì½œë°± ë©”ì†Œë“œ)
  public void afterEach() {
      memberRepository.clearStore();
  }
  ```

  - íšŒì›ê°€ì…ì˜ `member` ì´ë¦„ì„ "spring"ìœ¼ë¡œ, ì¤‘ë³µ íšŒì› ì˜ˆì™¸ì˜ `member1`ê³¼ `member2`ì˜ ì´ë¦„ë„ "spring"ìœ¼ë¡œ í–ˆì„ ë•Œ, ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
  - **Shift + F10**ìœ¼ë¡œ, ì´ì „ì— ì‹¤í–‰í•œ ê±¸ ê·¸ëŒ€ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.



- `íšŒì›ê°€ì…()` í˜¹ì€ `join()` í•¨ìˆ˜ ì‘ì„±

  ```java
  @Test
      void íšŒì›ê°€ì…() {
          // given
          Member member = new Member();
          member.setName("hello");
  
          // when
          Long saveId = memberService.join(member);
  
          // then
          Member findMember = memberService.findOne(saveId).get();
          assertThat(member.getName()).isEqualTo(findMember.getName());
      }
  ```



- ì¤‘ë³µ íšŒì›ì´ ê°€ì…í•  ë•Œ, ì˜ˆì™¸ ì²˜ë¦¬í•˜ëŠ” ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” í•¨ìˆ˜ë„ í•„ìš”í•˜ë‹¤.

- `ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸()` í•¨ìˆ˜ ì‘ì„± â‘ 

  ```java
  @Test
      public void ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸() {
          // given
          Member member1 = new Member();
          member1.setName("spring");
  
          Member member2 = new Member();
          member2.setName("spring");
  
          // when
          memberService.join(member1);
          try {
              memberService.join(member2);
              fail("ì˜ˆì™¸ê°€ ë°œìƒí•´ì•¼ í•©ë‹ˆë‹¤.");  // ì´ë¦„ì´ ê°™ìœ¼ë¯€ë¡œ, ì˜ˆì™¸ê°€ í•„ì—°ì ìœ¼ë¡œ ë°œìƒ. ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì‹¤íŒ¨.
          } catch (IllegalStateException e) {
              assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤."); // ë‹¤ë¥¸ ë©”ì‹œì§€ë¥¼ ë„£ìœ¼ë©´ ì‹¤íŒ¨
          }
      }
  ```

  - ì´ë¦„ì´ ê°™ì€ ë‘ Member ê°ì²´ê°€ ìˆì„ ë•Œ,
  - `member1`ì´ joiní•˜ê³  `member2`ê°€ joiní•  ë•Œ exceptionì„ ì²´í¬í•œë‹¤.
    - ë§Œì•½ tryì—ì„œ catchë¡œ ë„˜ì–´ê°„ë‹¤ë©´ ì‹¤íŒ¨
    - catchë¡œ ì¡ì€ ì—ëŸ¬ ë©”ì‹œì§€ê°€ MemberServiceì—ì„œ ë˜ì§„ ì—ëŸ¬ì˜ ë‚´ìš©ê³¼ ê°™ìœ¼ë©´ í…ŒìŠ¤íŠ¸ ì„±ê³µ
  - í•˜ì§€ë§Œ ë” ì¢‹ì€ êµ¬ë¬¸ì´ ìˆë‹¤.



- `ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸()` í•¨ìˆ˜ ì‘ì„± â‘¡

  ```java
  @Test
  public void ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸() {
      // given
      Member member1 = new Member();
      member1.setName("spring");
  
      Member member2 = new Member();
      member2.setName("spring");
  
      // when
      memberService.join(member1);
      IllegalStateException e = assertThrows(IllegalStateException.class, () -> memberService.join(member2));// member2ê°€ íšŒì›ê°€ì…í•  ë•Œ ì˜ˆì™¸ê°€ í„°ì ¸ì•¼ í•¨.
      assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤."); // ì—ëŸ¬ ë©”ì‹œì§€ ë‚´ìš©ë„ ê²€ì¦
  }
  ```

  - `assertThrow()`ë¥¼ í™œìš©í•˜ì—¬, ë°œìƒí•  ì˜¤ë¥˜ ì¢…ë¥˜ì™€ ëŒë‹¤ì‹ì„ ì ëŠ”ë‹¤.
    - ë§Œì•½ NullPointerExceptionì„ ë„£ìœ¼ë©´, í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨
  - ë°˜í™˜ë˜ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì €ì¥(**Ctrl + Alt + R**)í•˜ê³ , `assertThat`ì„ í†µí•´ ë©”ì‹œì§€ì˜ ë‚´ìš©ì„ í•œ ë²ˆ ë” ê²€ì¦í•œë‹¤.

---



### (3) `MemberRepository` ìƒì„±ì

- í˜„ì¬ `MemberService`ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `MemberService` íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ new í‚¤ì›Œë“œë¡œ ë§Œë“¤ì–´ ë‘” ìƒíƒœì´ë‹¤.

  ```java
  // MemberServiceTest.java
  MemberService memberService = new MemberService();
  MemoryMemberRepository memberRepository = new MemoryMemberRepository();
  ```



- ê·¸ `MemberService` í´ë˜ìŠ¤ì—ì„œëŠ” ì €ì¥ì†Œë¥¼ new í‚¤ì›Œë“œë¡œ ë§Œë“¤ì–´ ë‘ì—ˆë‹¤.

  ```java
  // MemberService.java
  private final MemberRepository memberRepository = new MemoryMemberRepository();
  ```



- ì¦‰, `MemberServiceTest.java`ì™€ `MemberService.java`ì˜ `memberRepository`ëŠ” ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì´ë‹¤.
- ë‘ ê°œë¥¼ ì“¸ ì´ìœ ê°€ ì—†ì„ ë¿ë”ëŸ¬, staticì´ ì•„ë‹Œ íƒ€ì…ìœ¼ë¡œ í–ˆì„ ë•Œ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ë„ ìˆê³ , ë‹¤ë¥¸ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´ ë‚´ìš©ë¬¼ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë‹¤ìŒê³¼ ê°™ì´ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡, **ìƒì„±ìë¥¼ ì‚¬ìš©**í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.



---

- **ğŸ“‘ `MemberService.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

  ```java
  // private final MemberRepository memberRepository = new MemoryMemberRepository();
  
  private final MemberRepository memberRepository;
  
  // ìƒì„±ì - ì™¸ë¶€ì—ì„œ MemberRepositoryë¥¼ ë§Œë“¤ë„ë¡ ì„¤ì •
  public MemberService(MemberRepository memberRepository) {
      this.memberRepository = memberRepository;
  }
  ```

  - `memberRepository`ë¥¼ new í‚¤ì›Œë“œë¡œ ìƒì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì™¸ë¶€ì—ì„œ ë„£ì–´ì£¼ë„ë¡ ë°”ê¿”ì¤€ ê²ƒ



- **ğŸ“‘ `MemberServiceTest.java` ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**

  ```java
  // MemberService memberService = new MemberService();
  // MemoryMemberRepository memberRepository = new MemoryMemberRepository();
  
  MemberService memberService;
  MemoryMemberRepository memberRepository; // í…ŒìŠ¤íŠ¸ ë°ì´í„° í´ë¦¬ì–´ë¥¼ ìœ„í•´ ê°€ì ¸ì˜´.
  
  @BeforeEach // ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ì— ë™ì‘
  public void beforeEach() {
      memberRepository = new MemoryMemberRepository();
      memberService = new MemberService(memberRepository);	// ìƒì„±ìë¥¼ í†µí•´ ìƒì„±í•˜ë¯€ë¡œ, ê°™ì€ MemoryMemberRepositoryë¥¼ ì‚¬ìš©
  }
  ```

  - í…ŒìŠ¤íŠ¸ê°€ ì„œë¡œ ì˜í–¥ì´ ì—†ë„ë¡ í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì˜ì¡´ ê´€ê³„ë„ ìƒˆë¡œ ë§ºì–´ì¤€ë‹¤.
  - ì´ë¥¼ **Dependency Injection(DI)**ì´ë¼ê³  í•œë‹¤.

---



### (4) ì „ì²´ ì½”ë“œ

- `MemberService.java`

  ```java
  package hello.hellospring.service;
  
  import hello.hellospring.domain.Member;
  import hello.hellospring.repository.MemberRepository;
  import hello.hellospring.repository.MemoryMemberRepository;
  
  import java.util.List;
  import java.util.Optional;
  
  public class MemberService {
  
      // private final MemberRepository memberRepository = new MemoryMemberRepository();
      private final MemberRepository memberRepository;
  
      // ìƒì„±ì - ì™¸ë¶€ì—ì„œ MemberRepositoryë¥¼ ë§Œë“¤ë„ë¡ ì„¤ì •
      public MemberService(MemberRepository memberRepository) {
          this.memberRepository = memberRepository;
      }
  
      /** íšŒì› ê°€ì… */
      public Long join(Member member) {
          validateDuplicateMember(member);    // ì¤‘ë³µëœ ì´ë¦„ì˜ íšŒì›ì€ ê°€ì… X
          memberRepository.save(member);
          return member.getId();
      }
  
      private void validateDuplicateMember(Member member) {
          // ë“œë˜ê·¸ í›„ Ctrl + Shift + Alt + Të¡œ ë©”ì†Œë“œ ì¶”ì¶œ
          // memberRepository.findByName(member.getName())ë§Œ ì¨ë†“ê³  Ctrl + Alt + Vë¥¼ í•˜ë©´ Optional ë³€ìˆ˜ì— ì €ì¥
          memberRepository.findByName(member.getName())
                          .ifPresent(m -> {   // nullì´ ì•„ë‹Œ ê°’ì´ë©´, í•´ë‹¹ ë¡œì§ ì‹¤í–‰
                              throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
                          });
      }
  
      /** ì „ì²´ íšŒì› ì¡°íšŒ */
      public List<Member> findMembers() {
          return memberRepository.findAll();
      }
  
      public Optional<Member> findOne(Long memberId) {
          return memberRepository.findById(memberId);
      }
  
  }
  ```



- `MemberServiceTest.java`

  ```java
  package hello.hellospring.service;
  
  import hello.hellospring.domain.Member;
  import hello.hellospring.repository.MemoryMemberRepository;
  import org.assertj.core.api.Assertions;
  import org.junit.jupiter.api.AfterEach;
  import org.junit.jupiter.api.BeforeEach;
  import org.junit.jupiter.api.Test;
  
  import static org.assertj.core.api.Assertions.*;
  import static org.junit.jupiter.api.Assertions.*;
  
  
  class MemberServiceTest {
  
      MemberService memberService;
      MemoryMemberRepository memberRepository; // í…ŒìŠ¤íŠ¸ ë°ì´í„° í´ë¦¬ì–´ë¥¼ ìœ„í•´ ê°€ì ¸ì˜´.
  
      @BeforeEach // ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ì— ë™ì‘
      public void beforeEach() {
          memberRepository = new MemoryMemberRepository();
          memberService = new MemberService(memberRepository);    // ìƒì„±ìë¥¼ í†µí•´ ìƒì„±í•˜ë¯€ë¡œ, ê°™ì€ MemoryMemberRepositoryë¥¼ ì‚¬ìš©
      }
  
      @AfterEach  // ë©”ì†Œë“œê°€ ì‹¤í–‰ì´ ëë‚  ë•Œë§ˆë‹¤ ë™ì‘ (ì½œë°± ë©”ì†Œë“œ)
      public void afterEach() {
          memberRepository.clearStore();
      }
  
      @Test
      void íšŒì›ê°€ì…() {
          // given
          Member member = new Member();
          member.setName("spring");
  
          // when
          Long saveId = memberService.join(member);
  
          // then
          Member findMember = memberService.findOne(saveId).get();
          assertThat(member.getName()).isEqualTo(findMember.getName());
          // Assertions.assertThat(member.getName()).isEqualTo(findMember.getName());    // ì‘ì„± í›„, Alt + Enterë¡œ static import
      }
  
      // join ì‹œ ì¤‘ë³µ íšŒì› ê²€ì‚¬ë¥¼ ìœ„í•´, í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì˜ˆì™¸ë¥¼ í„°ëœ¨ë¦¬ëŠ” ê²ƒì´ ë” ì¤‘ìš”í•˜ë‹¤.
      @Test
      public void ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸() {
          // given
          Member member1 = new Member();
          member1.setName("spring");
  
          Member member2 = new Member();
          member2.setName("spring");
  
          // when
          memberService.join(member1);
          IllegalStateException e = assertThrows(IllegalStateException.class, () -> memberService.join(member2));// member2ê°€ íšŒì›ê°€ì…í•  ë•Œ ì˜ˆì™¸ê°€ í„°ì ¸ì•¼ í•¨.
          assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤."); // ì—ëŸ¬ ë©”ì‹œì§€ ë‚´ìš©ë„ ê²€ì¦
  
  //        try {
  //            memberService.join(member2);
  //            fail("ì˜ˆì™¸ê°€ ë°œìƒí•´ì•¼ í•©ë‹ˆë‹¤.");  // ì´ë¦„ì´ ê°™ìœ¼ë¯€ë¡œ, ì˜ˆì™¸ê°€ í•„ì—°ì ìœ¼ë¡œ ë°œìƒ. ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ ì‹¤íŒ¨.
  //        } catch (IllegalStateException e) {
  //            assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤."); // ë‹¤ë¥¸ ë©”ì‹œì§€ë¥¼ ë„£ìœ¼ë©´ ì‹¤íŒ¨
  //        }
      }
  
      @Test
      void findMembers() {
      }
  
      @Test
      void findOne() {
      }
  
  }
  ```

  
